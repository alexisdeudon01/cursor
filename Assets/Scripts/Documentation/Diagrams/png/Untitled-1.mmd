---
title: Session Lifecycle - Activity Diagram
---
flowchart TD
    Start([üéÆ D√©but]) --> CheckHost{Host ou Client?}
    
    CheckHost -->|Host| CreateSession[Cr√©er Session<br/>SessionContainerManager.CreateSession]
    CheckHost -->|Client| RequestJoin[Demander Rejoindre<br/>SessionRpcHub.RequestJoinSessionServerRpc]
    
    CreateSession --> InitContainer[Initialiser Container<br/>SessionContainer.Initialize]
    InitContainer --> AuthorizeHost[Autoriser Host<br/>AuthorizeClient]
    AuthorizeHost --> WaitPlayers{Attendre Joueurs}
    
    RequestJoin --> ValidateClient{Valider Client?}
    ValidateClient -->|√âchec| RejectClient[Rejeter Client<br/>OnJoinFailed]
    ValidateClient -->|Succ√®s| AuthorizePlayer[Autoriser Joueur<br/>AuthorizeClient]
    
    RejectClient --> End([‚ùå Fin Rejet])
    
    AuthorizePlayer --> AddToSession[Ajouter √† Session<br/>AddPlayer]
    AddToSession --> NotifyAll[Notifier Tous<br/>PlayerJoinedClientRpc]
    NotifyAll --> WaitPlayers
    
    WaitPlayers -->|Min joueurs atteint| CheckStart{Host lance?}
    WaitPlayers -->|Timeout| Cleanup[Nettoyer Session]
    
    CheckStart -->|Non| WaitPlayers
    CheckStart -->|Oui| StartGame[D√©marrer Jeu<br/>State = InGame]
    
    StartGame --> SpawnPawns[Spawn Pawns<br/>Position avec Offset]
    SpawnPawns --> GameLoop{Game Loop}
    
    GameLoop -->|Joueur quitte| RemovePlayer[Retirer Joueur<br/>RevokeClient + RemovePlayer]
    GameLoop -->|Fin partie| EndSession[Fin Session<br/>State = Ended]
    GameLoop -->|Continue| GameLoop
    
    RemovePlayer --> CheckPlayers{Joueurs restants?}
    CheckPlayers -->|Oui| GameLoop
    CheckPlayers -->|Non| EndSession
    
    EndSession --> Cleanup
    Cleanup --> DisposeContainer[Dispose Container<br/>SessionContainer.Dispose]
    DisposeContainer --> End2([‚úÖ Fin Normale])
    
    style Start fill:#4caf50,color:#fff
    style End fill:#f44336,color:#fff
    style End2 fill:#4caf50,color:#fff
    style StartGame fill:#2196f3,color:#fff
    style AuthorizeHost fill:#ff9800,color:#fff
    style AuthorizePlayer fill:#ff9800,color:#fff